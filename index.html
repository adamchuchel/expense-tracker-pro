<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="V√Ωdaje Pro">
    <meta name="theme-color" content="#0f172a">
    <title>V√Ωdaje Pro - Skupinov√© finance</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Work+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app">
        <!-- Header with Group Selector -->
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <h1>üíé V√Ωdaje</h1>
                    <div class="group-selector" id="groupSelector">
                        <button class="current-group" id="currentGroup">
                            <span id="currentGroupName">V√Ωchoz√≠ skupina</span>
                            <span class="dropdown-icon">‚ñº</span>
                        </button>
                        <div class="group-dropdown hidden" id="groupDropdown">
                            <div class="group-list" id="groupList"></div>
                            <button class="add-group-btn" id="addGroupBtn">+ Nov√° skupina</button>
                        </div>
                    </div>
                </div>
                <button id="syncBtn" class="sync-btn" title="Synchronizovat">
                    <span class="sync-icon">‚ü≥</span>
                </button>
            </div>
        </header>

        <!-- Connection Status -->
        <div id="connectionStatus" class="connection-status hidden">
            <span id="statusText"></span>
        </div>

        <!-- Navigation Tabs -->
        <nav class="tabs">
            <button class="tab active" data-tab="add">
                <span class="tab-icon">‚ûï</span>
                <span class="tab-label">P≈ôidat</span>
            </button>
            <button class="tab" data-tab="expenses">
                <span class="tab-icon">üìã</span>
                <span class="tab-label">V√Ωdaje</span>
            </button>
            <button class="tab" data-tab="balance">
                <span class="tab-icon">üí∞</span>
                <span class="tab-label">Bilance</span>
            </button>
            <button class="tab" data-tab="stats">
                <span class="tab-icon">üìä</span>
                <span class="tab-label">Statistiky</span>
            </button>
            <button class="tab" data-tab="settings">
                <span class="tab-icon">‚öôÔ∏è</span>
                <span class="tab-label">Nastaven√≠</span>
            </button>
        </nav>

        <!-- Tab Content -->
        <div class="content">
            
            <!-- Add Expense/Income Tab -->
            <div id="addTab" class="tab-content active">
                <div class="add-type-selector">
                    <button class="type-btn active" data-type="expense">V√Ωdaj</button>
                    <button class="type-btn" data-type="income">P≈ô√≠jem</button>
                </div>

                <!-- Expense Form -->
                <form id="expenseForm" class="transaction-form">
                    <div class="form-group">
                        <label for="description">Popis</label>
                        <input type="text" id="description" placeholder="Nap≈ô. Veƒçe≈ôe v restauraci" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group flex-1">
                            <label for="amount">ƒå√°stka</label>
                            <input type="number" id="amount" placeholder="0" step="0.01" required>
                        </div>
                        <div class="form-group" style="width: 120px;">
                            <label for="currency">Mƒõna</label>
                            <select id="currency">
                                <option value="CZK" selected>CZK</option>
                                <option value="EUR">EUR</option>
                                <option value="USD">USD</option>
                                <option value="GBP">GBP</option>
                                <option value="THB">THB</option>
                                <option value="PLN">PLN</option>
                            </select>
                        </div>
                    </div>

                    <div id="currencyNote" class="currency-note hidden">
                        <span id="currencyConversion"></span>
                    </div>

                    <div class="form-row">
                        <div class="form-group flex-1">
                            <label for="date">Datum</label>
                            <input type="date" id="date" required>
                        </div>
                        <div class="form-group flex-1">
                            <label for="time">ƒåas</label>
                            <input type="time" id="time" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="paidBy">Kdo platil</label>
                        <select id="paidBy" required>
                            <option value="">Vyber osobu</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="category">Kategorie</label>
                        <select id="category">
                            <!-- Dynamically populated -->
                        </select>
                    </div>

                    <div class="form-group">
                        <label>
                            Rozdƒõlit mezi
                            <span class="split-mode-toggle">
                                <button type="button" class="mode-btn active" data-mode="equal">Rovnomƒõrnƒõ</button>
                                <button type="button" class="mode-btn" data-mode="custom">Vlastn√≠ ƒç√°stky</button>
                            </span>
                        </label>
                        <div id="splitBetween" class="split-container">
                            <!-- Dynamically populated -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="note">Pozn√°mka (voliteln√©)</label>
                        <textarea id="note" placeholder="Dodateƒçn√© informace k v√Ωdaji..." rows="3"></textarea>
                    </div>

                    <button type="submit" class="btn-primary">
                        <span class="btn-icon">üí∏</span>
                        P≈ôidat v√Ωdaj
                    </button>
                </form>

                <!-- Income Form -->
                <form id="incomeForm" class="transaction-form hidden">
                    <div class="form-group">
                        <label for="incomeDescription">Popis p≈ô√≠jmu</label>
                        <input type="text" id="incomeDescription" placeholder="Nap≈ô. Vr√°cen√≠ penƒõz, v√Ωplata..." required>
                    </div>

                    <div class="form-row">
                        <div class="form-group flex-1">
                            <label for="incomeAmount">ƒå√°stka</label>
                            <input type="number" id="incomeAmount" placeholder="0" step="0.01" required>
                        </div>
                        <div class="form-group" style="width: 120px;">
                            <label for="incomeCurrency">Mƒõna</label>
                            <select id="incomeCurrency">
                                <option value="CZK" selected>CZK</option>
                                <option value="EUR">EUR</option>
                                <option value="USD">USD</option>
                                <option value="GBP">GBP</option>
                                <option value="THB">THB</option>
                                <option value="PLN">PLN</option>
                            </select>
                        </div>
                    </div>

                    <div id="incomeCurrencyNote" class="currency-note hidden">
                        <span id="incomeCurrencyConversion"></span>
                    </div>

                    <div class="form-row">
                        <div class="form-group flex-1">
                            <label for="incomeDate">Datum</label>
                            <input type="date" id="incomeDate" required>
                        </div>
                        <div class="form-group flex-1">
                            <label for="incomeTime">ƒåas</label>
                            <input type="time" id="incomeTime" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="incomeRecipient">Komu</label>
                        <select id="incomeRecipient" required>
                            <option value="">Vyber osobu</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="incomeNote">Pozn√°mka (voliteln√©)</label>
                        <textarea id="incomeNote" placeholder="Dodateƒçn√© informace k p≈ô√≠jmu..." rows="3"></textarea>
                    </div>

                    <button type="submit" class="btn-primary btn-income">
                        <span class="btn-icon">üíµ</span>
                        P≈ôidat p≈ô√≠jem
                    </button>
                </form>
            </div>

            <!-- Expenses List Tab -->
            <div id="expensesTab" class="tab-content">
                <div class="filter-bar">
                    <select id="filterType" class="filter-select">
                        <option value="all">V≈°e</option>
                        <option value="expense">Pouze v√Ωdaje</option>
                        <option value="income">Pouze p≈ô√≠jmy</option>
                    </select>
                    <select id="filterCategory" class="filter-select">
                        <option value="all">V≈°echny kategorie</option>
                    </select>
                </div>
                <div id="expensesList" class="expenses-list">
                    <p class="empty-state">Zat√≠m ≈æ√°dn√© transakce</p>
                </div>
            </div>

            <!-- Balance Tab -->
            <div id="balanceTab" class="tab-content">
                <div class="balance-summary">
                    <div class="summary-card">
                        <div class="summary-label">Celkov√© v√Ωdaje</div>
                        <div class="summary-value" id="totalExpenses">0 Kƒç</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-label">Celkov√© p≈ô√≠jmy</div>
                        <div class="summary-value income-color" id="totalIncomes">0 Kƒç</div>
                    </div>
                </div>

                <div class="section-header">
                    <h3>üí≥ Bilance ƒçlen≈Ø</h3>
                </div>
                <div id="balanceList" class="balance-list">
                    <p class="empty-state">Zat√≠m ≈æ√°dn√© dluhy</p>
                </div>

                <div class="section-header">
                    <h3>üí∏ Vyrovn√°n√≠ dluh≈Ø</h3>
                </div>
                <div id="settlementList" class="settlement-list">
                    <p class="empty-state">V≈°echno je vyrovnan√©! üéâ</p>
                </div>
            </div>

            <!-- Statistics Tab -->
            <div id="statsTab" class="tab-content">
                <div class="stats-header">
                    <h2>üìä Statistiky a p≈ôehledy</h2>
                    <select id="statsTimeRange" class="filter-select">
                        <option value="all">Celkem</option>
                        <option value="month">Tento mƒõs√≠c</option>
                        <option value="week">Tento t√Ωden</option>
                    </select>
                </div>

                <div class="chart-container">
                    <h3>V√Ωdaje podle kategori√≠</h3>
                    <canvas id="categoryChart"></canvas>
                </div>

                <div class="chart-container">
                    <h3>ƒåasov√Ω v√Ωvoj</h3>
                    <canvas id="timelineChart"></canvas>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üìà</div>
                        <div class="stat-value" id="avgExpense">0 Kƒç</div>
                        <div class="stat-label">Pr≈Ømƒõrn√Ω v√Ωdaj</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-value" id="topCategory">-</div>
                        <div class="stat-label">Top kategorie</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üë§</div>
                        <div class="stat-value" id="topSpender">-</div>
                        <div class="stat-label">Nejv√≠ce utratil</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìÖ</div>
                        <div class="stat-value" id="expenseCount">0</div>
                        <div class="stat-label">Poƒçet v√Ωdaj≈Ø</div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settingsTab" class="tab-content">
                <div class="settings">
                    
                    <div class="settings-section">
                        <h3>üè∑Ô∏è Kategorie v√Ωdaj≈Ø</h3>
                        <div id="categoriesList" class="categories-list">
                            <!-- Dynamically populated -->
                        </div>
                        <div class="add-category">
                            <input type="text" id="newCategoryName" placeholder="N√°zev kategorie">
                            <input type="text" id="newCategoryIcon" placeholder="Emoji" maxlength="2" style="width: 60px;">
                            <button id="addCategory" class="btn-secondary">P≈ôidat</button>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>üë• √öƒçastn√≠ci skupiny</h3>
                        <div id="membersList" class="members-list">
                            <!-- Dynamically populated -->
                        </div>
                        <div class="add-member">
                            <input type="text" id="newMember" placeholder="Jm√©no nov√©ho √∫ƒçastn√≠ka">
                            <button id="addMember" class="btn-secondary">P≈ôidat</button>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>‚òÅÔ∏è Google Sheets p≈ôipojen√≠</h3>
                        <div class="form-group">
                            <label for="sheetId">ID Google tabulky</label>
                            <input type="text" id="sheetId" placeholder="Vlo≈æ ID tabulky">
                            <small>Najde≈° v URL: docs.google.com/spreadsheets/d/<strong>ID_TABULKY</strong>/edit</small>
                        </div>
                        <div class="form-group">
                            <label for="apiKey">Google API kl√≠ƒç</label>
                            <input type="password" id="apiKey" placeholder="Vlo≈æ API kl√≠ƒç">
                        </div>
                        <button id="saveConnection" class="btn-primary">Ulo≈æit p≈ôipojen√≠</button>
                        <button id="testConnection" class="btn-secondary">Test p≈ôipojen√≠</button>
                    </div>

                    <div class="settings-section">
                        <h3>üóëÔ∏è Data</h3>
                        <button id="clearGroupData" class="btn-warning">Smazat data t√©to skupiny</button>
                        <button id="clearAllData" class="btn-danger">Smazat v≈°echna data</button>
                    </div>

                    <div class="settings-section">
                        <h3>‚ÑπÔ∏è O aplikaci</h3>
                        <p><strong>Verze:</strong> 2.0.0 Pro</p>
                        <p><strong>Funkce:</strong> Skupiny, Multi-mƒõna, Grafy, Vyrovn√°n√≠ dluh≈Ø</p>
                        <p>Offline PWA pro profesion√°ln√≠ sledov√°n√≠ skupinov√Ωch financ√≠</p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Modals -->
    <div id="groupModal" class="modal hidden">
        <div class="modal-content">
            <h3>Nov√° skupina</h3>
            <div class="form-group">
                <label for="groupName">N√°zev skupiny</label>
                <input type="text" id="groupName" placeholder="Nap≈ô. Thajsko 2025, Leden 2025...">
            </div>
            <div class="modal-actions">
                <button id="cancelGroup" class="btn-secondary">Zru≈°it</button>
                <button id="saveGroup" class="btn-primary">Vytvo≈ôit</button>
            </div>
        </div>
    </div>

    <div id="settlementModal" class="modal hidden">
        <div class="modal-content">
            <h3>Vyrovnat dluh</h3>
            <p id="settlementText"></p>
            <div class="modal-actions">
                <button id="cancelSettlement" class="btn-secondary">Zru≈°it</button>
                <button id="confirmSettlement" class="btn-primary">Oznaƒçit jako vyrovn√°no</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
